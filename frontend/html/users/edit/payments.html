{% extends "layout.html" %}
{% load static %}
{% load text_filters %}

{% block title %}
    –ö–ª—É–±–Ω—ã–µ –≤–∑–Ω–æ—Å—ã ‚Äî {{ block.super }}
{% endblock %}

{% block content %}
    <div class="content user-edit">
        <div class="form-title">üé©<br>–ö–ª—É–±–Ω—ã–µ –≤–∑–Ω–æ—Å—ã</div>

        <div class="block-subheader">
            –ö–ª—É–±–Ω–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞ –¥–æ <strong>{{ me.membership_expires_at | date:"j E Y" }}</strong> ‚Äî —ç—Ç–æ <span class="badge-price">üíé {{ me.membership_days_left|floor }} {{ me.membership_days_left|rupluralize:"–¥–µ–Ω—å,–¥–Ω—è,–¥–Ω–µ–π" }}</span>
        </div>

        {% if me.membership_platform_type == "patreon" %}
            <div class="block pay-subscription">
                üôÇ –ü–æ–¥–∫–ª—é—á—ë–Ω <a href="https://www.patreon.com/vas3k" target="_blank">Patreon</a>.
                –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø—Ä—è–º—É—é –æ–ø–ª–∞—Ç—É –Ω–∏–∂–µ.
            </div>
        {% else %}
            {% if not subscriptions %}
                <div class="block pay-subscription">–ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ üòü</div>
            {% endif %}
        {% endif %}

        {% for subscription in subscriptions %}
            <div class="block pay-subscription">
                üî• –í–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ <strong>‚Ç¨{{ subscription.amount | floatformat }}</strong> –∫–∞–∂–¥—ã–π
                {% if subscription.interval == "month" %}
                    –º–µ—Å—è—Ü <strong>{{ subscription.next_charge_at | date:"j" }} —á–∏—Å–ª–∞</strong>
                {% else %}
                    –≥–æ–¥ <strong>{{ subscription.next_charge_at | date:"j E" }}</strong>
                {% endif %}

                <br><br>

                <a href="{% url "stop_subscription" subscription.id %}" class="button button-small" onclick="return confirm('–¢–æ—á–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º?')">–û—Ç–∫–ª—é—á–∏—Ç—å</a>
            </div>
        {% endfor %}

        {% if me.membership_platform_type == "direct" %}
            <div class="block-description block-description-center">
                –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–∫–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–ª–∏ –æ—Ç–º–µ–Ω—ã –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ –º–æ–∂–Ω–æ –µ—â–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="{{ settings.STRIPE_CUSTOMER_PORTAL_URL }}" target="_blank">Stripe Customer Portal</a> (email —Ç–æ—Ç –∂–µ —á—Ç–æ –≤ –ö–ª—É–±–µ).
            </div>
        {% endif %}

        <div class="block-description block-description-center">
            –û –ª—é–±—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –æ–ø–ª–∞—Ç–æ–π —Å—Ä–∞–∑—É –ø–∏—à–∏—Ç–µ –Ω–∞ <a href="mailto:monies@vas3k.club">monies@vas3k.club</a>.<br>
            –ú—ã –º–æ–∂–µ–º –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏–ª–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å –ª—é–±—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, —Ç–∞–∫ —á—Ç–æ –Ω–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å.
        </div>

        <form action="{% url "pay" %}" method="get">

        <div class="block-header" id="select_package">–ù–∞ —Å–∫–æ–ª—å–∫–æ –µ—â–µ –ø–æ–ø–æ–ª–Ω—è–µ–º?</div>

        <br>

        {% include "payments/blocks/packages.html" %}

        <button type="submit" class="button button-big join-button">–ü—Ä–æ–¥–ª–∏—Ç—å —á–ª–µ–Ω—Å—Ç–≤–æ ü§ô</button>

        </form>

        <br><br>

        <div class="block-description block-description-center">
            –ü–æ–ø–æ–ª–Ω—è–π—Ç–µ –∫–æ–≥–¥–∞ –≤–∞–º —É–¥–æ–±–Ω–æ ‚Äî –Ω–æ–≤—ã–µ –¥–Ω–∏ –±—É–¥—É—Ç –ø—Ä–æ—Å—Ç–æ —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å—Å—è.
        </div>

        <div class="block-description block-description-center">
            –î–∞–∂–µ –≥–æ–¥–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –º–æ–∂–Ω–æ –ø–æ–∫—É–ø–∞—Ç—å –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ–∏—á–∞ –¥–ª—è –¥–∏–∫–∏—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –µ—â–µ –±–æ–ª—å—à–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ö–ª—É–±!
        </div>

        <div class="block-header" style="max-width: 600px; margin-top: 100px;">üèÖ<br>–ê —á—Ç–æ–±—ã –±—ã–ª–æ –≤–µ—Å–µ–ª–µ–µ, –≤–æ—Ç —Ç–æ–ø —á–ª–µ–Ω–æ–≤ –ö–ª—É–±–∞ —Å —Å–∞–º–æ–π –¥–ª–∏–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π</div>

        <div class="block-description">
            –í—Å–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –≤–∑–Ω–æ—Å—ã –∏–¥—É—Ç –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ –ö–ª—É–±–∞, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤–∞–º —Ö–æ—á–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∏–ª–∏ –æ—Ç–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å –ö–ª—É–± –∑–∞ –ø–æ–º–æ—â—å,
            –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å ‚Äî –ø—Ä–æ–¥–ª–∏—Ç—å —Å–≤–æ—é –∫–∞—Ä—Ç—É –µ—â—ë –Ω–∞ –ø–∞—Ä—É —Ç—ã—Å—è—á –ª–µ—Ç –≤–ø–µ—Ä—ë–¥ :D
        </div>
    </div>

    <div class="block stats-top-users">
        <div class="top-users top-users-big">
            {% for user in top_users|slice:"0:5" %}
                <a class="user user-round zoom-on-hover" href="{% url "profile" user.slug %}">
                    <span class="user-round-avatar-badge">üèÜ</span>
                    <span class="avatar user-round-avatar">
                        <img src="{{ user.get_avatar }}" alt="–ê–≤–∞—Ç–∞—Ä {{ user.full_name }}" loading="lazy" />
                    </span>
                    <span class="user-round-name">#{{ forloop.counter }}: {{ user.full_name }}</span>
                    <span class="user-round-info">–¥–æ {{ user.membership_expires_at | date:"E Y" }} –≥–æ–¥–∞</span>
                </a>
            {% endfor %}
        </div>

        <div class="top-users top-users-medium">
            {% for user in top_users|slice:"5:25" %}
                <a class="user user-round zoom-on-hover" href="{% url "profile" user.slug %}">
                    <span class="avatar user-round-avatar">
                        <img src="{{ user.get_avatar }}" alt="–ê–≤–∞—Ç–∞—Ä {{ user.full_name }}" loading="lazy" />
                    </span>
                    <span class="user-round-name">#{{ forloop.counter|add:5 }}: {{ user.full_name }}</span>
                </a>
            {% endfor %}
        </div>
    </div>

    <div class="content user-edit" id="invite">
        <div class="block-header">üíå<br>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞</div>

        <div class="block-description block-description-center">
            <a href="{% url "invites" %}" class="button">üéÅ –ò–Ω–≤–∞–π—Ç—ã –ø–µ—Ä–µ–µ—Ö–∞–ª–∏ —Å—é–¥–∞</a>
        </div>
    </div>
{% endblock %}
