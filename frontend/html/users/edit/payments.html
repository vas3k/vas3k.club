{% extends "layout.html" %}
{% load static %}
{% load text_filters %}

{% block title %}
    –ö–ª—É–±–Ω—ã–µ –≤–∑–Ω–æ—Å—ã ‚Äî {{ block.super }}
{% endblock %}

{% block content %}
    <div class="content user-edit">
        <div class="form-title">üé©<br>–ö–ª—É–±–Ω—ã–µ –≤–∑–Ω–æ—Å—ã</div>

        <div class="block-subheader">
            –ß–ª–µ–Ω—Å—Ç–≤–æ –≤ –∫–ª—É–±–µ –∞–∫—Ç–∏–≤–Ω–æ –¥–æ <strong>{{ me.membership_expires_at | date:"j E Y" }}</strong> ‚Äî —ç—Ç–æ <span class="badge-price">üíé {{ me.membership_days_left|floor }} {{ me.membership_days_left|rupluralize:"–¥–µ–Ω—å,–¥–Ω—è,–¥–Ω–µ–π" }}</span>
        </div>

        {% if not features.FREE_MEMBERSHIP %}
            {% if me.membership_platform_type == "patreon" %}
                <div class="block pay-subscription">
                    üôÇ –ü–æ–¥–∫–ª—é—á—ë–Ω <a href="https://www.patreon.com/vas3k" target="_blank">Patreon</a>.
                    –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø—Ä—è–º—É—é –æ–ø–ª–∞—Ç—É –Ω–∏–∂–µ.
                </div>
            {% else %}
                {% if not subscriptions %}
                    <div class="block pay-subscription">–ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ üòü</div>
                {% endif %}
            {% endif %}

            {% for subscription in subscriptions %}
                <div class="block pay-subscription">
                    üî• –í–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ <strong>‚Ç¨{{ subscription.amount | floatformat }}</strong> –∫–∞–∂–¥—ã–π
                    {% if subscription.interval == "month" %}
                        –º–µ—Å—è—Ü <strong>{{ subscription.next_charge_at | date:"j" }} —á–∏—Å–ª–∞</strong>
                    {% else %}
                        –≥–æ–¥ <strong>{{ subscription.next_charge_at | date:"j E" }}</strong>
                    {% endif %}

                    <br><br>

                    <a href="{% url "stop_subscription" subscription.id %}" class="button button-small" onclick="return confirm('–¢–æ—á–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º?')">–û—Ç–∫–ª—é—á–∏—Ç—å</a>
                </div>
            {% endfor %}

            <div class="block-description block-description-center">
                –û –ª—é–±—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –æ–ø–ª–∞—Ç–æ–π —Å—Ä–∞–∑—É –ø–∏—à–∏—Ç–µ –Ω–∞ <a href="mailto:money@pmi.moscow">money@pmi.moscow</a>.<br>
                –ú—ã –º–æ–∂–µ–º –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏–ª–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å –ª—é–±—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, —Ç–∞–∫ —á—Ç–æ –Ω–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å.
            </div>

            <form action="{% url "pay" %}" method="get">

            <div class="block-header" id="select_package">–ù–∞ —Å–∫–æ–ª—å–∫–æ –µ—â–µ –ø–æ–ø–æ–ª–Ω—è–µ–º?</div>

            <br>

            {% include "payments/blocks/packages.html" %}

            <button type="submit" class="button button-big join-button">–ü—Ä–æ–¥–ª–∏—Ç—å —á–ª–µ–Ω—Å—Ç–≤–æ ü§ô</button>

            </form>

            <br><br>

            <div class="block-description block-description-center">
                –ü–æ–ø–æ–ª–Ω—è–π—Ç–µ –∫–æ–≥–¥–∞ –≤–∞–º —É–¥–æ–±–Ω–æ ‚Äî –Ω–æ–≤—ã–µ –¥–Ω–∏ –±—É–¥—É—Ç –ø—Ä–æ—Å—Ç–æ —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å—Å—è.
            </div>

            <div class="block-description block-description-center">
                –î–∞–∂–µ –≥–æ–¥–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –º–æ–∂–Ω–æ –ø–æ–∫—É–ø–∞—Ç—å –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ–∏—á–∞ –¥–ª—è –¥–∏–∫–∏—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –µ—â–µ –±–æ–ª—å—à–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ö–ª—É–±!
            </div>
        
            <div class="block-header" style="max-width: 600px; margin-top: 100px;">üèÖ<br>–ê —á—Ç–æ–±—ã –±—ã–ª–æ –≤–µ—Å–µ–ª–µ–µ, –≤–æ—Ç —Ç–æ–ø —á–ª–µ–Ω–æ–≤ –ö–ª—É–±–∞ —Å —Å–∞–º–æ–π –¥–ª–∏–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π</div>

            <div class="block-description">
                –í—Å–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –≤–∑–Ω–æ—Å—ã –∏–¥—É—Ç –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ –ö–ª—É–±–∞, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤–∞–º —Ö–æ—á–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∏–ª–∏ –æ—Ç–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å –ö–ª—É–± –∑–∞ –ø–æ–º–æ—â—å,
                –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å ‚Äî –ø—Ä–æ–¥–ª–∏—Ç—å —Å–≤–æ—é –∫–∞—Ä—Ç—É –µ—â—ë –Ω–∞ –ø–∞—Ä—É —Ç—ã—Å—è—á –ª–µ—Ç –≤–ø–µ—Ä—ë–¥ :D
            </div>
        {% else %}
            <div class="block-description">
                –ß–ª–µ–Ω—Å—Ç–≤–æ –≤ –∫–ª—É–±–µ –ø–æ–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ. –î–ª—è –ø—Ä–æ–¥–ª–µ–Ω–∏—è —á–ª–µ–Ω—Å—Ç–≤–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–º –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º –∏ –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞–º.
            </div>

            <div class="block-header" style="max-width: 600px; margin-top: 100px;">üèÖ<br>–ê —á—Ç–æ–±—ã –±—ã–ª–æ –≤–µ—Å–µ–ª–µ–µ, –≤–æ—Ç —Ç–æ–ø —á–ª–µ–Ω–æ–≤ –ö–ª—É–±–∞ —Å —Å–∞–º–æ–π –¥–ª–∏–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–æ–π</div>
        {% endif %}
    </div>

    <div class="block stats-top-users">
        <div class="top-users">
            {% for user in top_users|slice:"0:5" %}
                <a href="{% url "profile" user.slug %}" class="top-user top-user-big">
                    <span class="top-user-avatar-badge">üèÜ</span>
                    <span class="avatar top-user-avatar">
                        <img src="{{ user.get_avatar }}" alt="–ê–≤–∞—Ç–∞—Ä {{ user.full_name }}" loading="lazy" />
                    </span>
                    <span class="top-user-name">#{{ forloop.counter }}: {{ user.full_name }}</span>
                    <span class="top-user-info">–¥–æ {{ user.membership_expires_at | date:"E Y" }} –≥–æ–¥–∞</span>
                </a>
            {% endfor %}
        </div>

        <div class="top-users">
            {% for user in top_users|slice:"5:25" %}
                <a href="{% url "profile" user.slug %}" class="top-user top-user-medium">
                    <span class="avatar top-user-avatar">
                        <img src="{{ user.get_avatar }}" alt="–ê–≤–∞—Ç–∞—Ä {{ user.full_name }}" loading="lazy" />
                    </span>
                    <span class="top-user-name">#{{ forloop.counter|add:5 }}: {{ user.full_name }}</span>
                    <span class="top-user-info">{{ user.membership_expires_at | date:"F Y" | lower }}</span>
                </a>
            {% endfor %}
        </div>

        <div class="top-users">
            {% for user in top_users|slice:"25:64" %}
                <a href="{% url "profile" user.slug %}" class="top-user top-user-small" title="–¥–æ {{ user.membership_expires_at | date:"E Y" }} –≥–æ–¥–∞">
                    <span class="avatar top-user-avatar">
                        <img src="{{ user.get_avatar }}" alt="–ê–≤–∞—Ç–∞—Ä {{ user.full_name }}" loading="lazy" />
                    </span>
                </a>
            {% endfor %}
        </div>
    </div>

    <div class="content user-edit" id="invite">
        <div class="block-header">üíå<br>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞</div>

        <div class="block-description block-description-center">
            –£ –≤–∞—Å –µ—Å—Ç—å —Ö–æ—Ä–æ—à–∏–π –∑–Ω–∞–∫–æ–º—ã–π, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ–∂–µ —Ö–æ—á–µ—Ç –≤ –ö–ª—É–±, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –∑–∞–ø–ª–∞—Ç–∏—Ç—å –¥–æ–ª–æ—Ä?
        </div>

        <div class="block-description block-description-center">
            –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–≤–µ—Å—Ç–∏ –ø–æ—á—Ç—É –ª—é–±–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –∏ –ø–æ–¥–∞—Ä–∏—Ç—å –µ–º—É –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ –≥–æ–¥!
            –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å –≤—ã—Å–ª–∞—Ç—å –µ–º—É –∏–Ω–≤–∞–π—Ç, –≤–µ–¥—å –∏–Ω—Ç—Ä–æ –µ–º—É –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–∏–¥—ë—Ç—Å—è –Ω–∞–ø–∏—Å–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.
        </div>

        <div class="block invite-friend">
            <form action="{% url "pay" %}" method="get">
                {% csrf_token %}
                <input type="hidden" name="product_code" value="club1_invite">
                <input type="hidden" name="is_invite" value="true">

                <label>
                    <strong>–ê–¥—Ä–µ—Å –ø–æ—á—Ç—ã</strong>
                    <input type="email" name="email" placeholder="friend@gmail.com" required>
                </label>

                <button type="submit" class="button">–ü–æ–∑–≤–∞—Ç—å –≤ –ö–ª—É–±</button>
            </form>
        </div>

        <div class="block-description block-description-center">
            üí° <strong>–õ–∞–π—Ñ—Ö–∞–∫:</strong> —É–∫–∞–∑–∞–≤ –∑–¥–µ—Å—å –ø–æ—á—Ç—É —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —á–ª–µ–Ω–∞ –ö–ª—É–±–∞, –≤—ã –ø—Ä–æ–¥–ª–∏—Ç–µ –µ–º—É –∞–∫–∫–∞—É–Ω—Ç. –¢–æ–ª—å–∫–æ —Å–ø—Ä–æ—Å–∏—Ç–µ –µ–≥–æ —Ç–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å.
        </div>
    </div>
{% endblock %}
