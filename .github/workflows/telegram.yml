name: Telegram Bridge

on:
  issue_comment:
    types: [ created ]
  issues:
    types: [ opened, edited, closed, reopened ]
  pull_request:
    types: [ opened, ready_for_review, review_requested, reopened ]
  push:

jobs:
  build:
    name: Telegram Bridge
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Notify about issue comment
        if: ${{ github.event_name == 'issue_comment' && github.event.action == 'created'}}
        uses: ./.github/actions/tg
        with:
          text: "üó£ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç @${{ github.event.comment.user.login }} –≤ [${{ github.event.issue.title }}](${{ github.event.issue.html_url }}) - ${{ github.event.comment.body }}"
          token: ${{ secrets.TELEGRAM_DEV_BOT_TOKEN }}
      - name: Notify about new issue
        if: ${{ github.event_name == 'issues' && github.event.action == 'opened'}}
        uses: ./.github/actions/tg
        with:
          text: "üëæ –ó–∞–¥–∞—á –ø—Ä–∏–≤–∞–ª–∏–ª–æ: [${{ github.event.issue.title }}](${{ github.event.issue.html_url }}) –æ—Ç @${{ github.event.issue.user.login }}"
          token: ${{ secrets.TELEGRAM_DEV_BOT_TOKEN }}
      - name: Notify about issue closed
        if: ${{ github.event_name == 'issues' && github.event.action == 'closed'}}
        uses: ./.github/actions/tg
        with:
          text: "‚úÖ –ó–∞–¥–∞—á–∞ –∑–∞–∫—Ä—ã—Ç–∞: [${{ github.event.issue.title }}](${{ github.event.issue.html_url }})"
          token: ${{ secrets.TELEGRAM_DEV_BOT_TOKEN }}
      - name: Notify about issue reopen
        if: ${{ github.event_name == 'issues' && github.event.action == 'reopened'}}
        uses: ./.github/actions/tg
        with:
          text: "‚ôªÔ∏è –ß—Ç–æ-—Ç–æ –Ω–µ –¥–æ–¥–µ–ª–∞–ª–∏ –≤ –∑–∞–¥–∞—á–µ, —Å–Ω–æ–≤–∞ –æ—Ç–∫—Ä—ã—Ç–∞: [${{ github.event.issue.title }}](${{ github.event.issue.html_url }})"
          token: ${{ secrets.TELEGRAM_DEV_BOT_TOKEN }}
      - name: Notify about PR open
        if: ${{ github.event_name == 'pull_request' && (github.event.action == 'opened' || github.event.action == 'reopened') }}
        uses: ./.github/actions/tg
        with:
          text: "üõ† @${{ github.event.pull_request.user.login}} –ø—Ä–∏—Å–ª–∞–ª –Ω–æ–≤—ã–π PR: [${{ github.event.pull_request.title}}](${{ github.event.pull_request.html_url}})"
          token: ${{ secrets.TELEGRAM_DEV_BOT_TOKEN }}
      - name: Notify about PR ready for review
        if: ${{ github.event_name == 'pull_request' && github.event.action == 'ready_for_review'}}
        uses: ./.github/actions/tg
        with:
          text: "‚úÖ PR [${{ github.event.pull_request.title}}](${{ github.event.pull_request.html_url}}) –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É"
          token: ${{ secrets.TELEGRAM_DEV_BOT_TOKEN }}
      - name: Notify about PR open
        if: ${{ github.event_name == 'pull_request' && github.event.action == 'review_requested'}}
        uses: ./.github/actions/tg
        with:
          text: "‚ùóÔ∏è–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–≤—å—é –¥–ª—è PR: [${{ github.event.pull_request.title}}](${{ github.event.pull_request.html_url}})"
          token: ${{ secrets.TELEGRAM_DEV_BOT_TOKEN }}
      - name: Notify about push in master
        if: ${{ github.event_name == 'push' && github.event.ref == 'refs/heads/master'}}
        uses: ./.github/actions/tg
        with:
          text: "üíö –ü—É—à –≤ –º–∞—Å—Ç–µ—Ä–µ –æ—Ç @${{ github.event.head_commit.author.username}}: [${{ github.event.head_commit.message}}](${{ github.event.head_commit.url}}"
          token: ${{ secrets.TELEGRAM_DEV_BOT_TOKEN }}
